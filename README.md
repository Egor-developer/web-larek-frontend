# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Архитектура проекта "Веб-ларек"

# Архитектура MVP
  * Model - класс AppState. 
    Слой данных и бизнес-логики. Модель отвечает за доступ к данным, их обработку и манипуляцию.

  * View - классы ProductCard, PageLayout, Form, Basket.
    Отвечает за отображение данных пользователю и взаимодействие с пользователем. Визуальные элементы,
    компоненты пользовательского интерфейса

  * Present - в роли Present выступает код в файле index.ts Объединяет Model и View через событийную модель.

# Базовые компоненты:

## Класс api
  Класс для взаимодействия с сервером.

  ### Свойства класса
  * baseUrl: string - основной url
  * requestOptions: string - настройки запроса

  ### Методы класса
  * handleResponse - ответ сервера, ошибки
  * getRequest - get запрос
  * postRequest - post запрос

# Класс events
  Брокер событий, позволяет управлять подписками на события и их обработчиками.

  ### Свойства класса
  * _events: Map<EventName, Set<Subscriber>> - это коллекция событий и их подписчиков.

  ### Методы класса
  * on - устанавливает обработчик
  * off - снять обработчик
  * emitEvent - Инициировать событие с данными
  * onAll - Слушать все события
  * offAll - Сбросить все обработчики
  * trigger - Коллбек триггер, генерирующий событие при вызове

# Общие компоненты

# Класс Form
  Класс предназначен для управления состоянием формы, обработчки событий ввода.

  ### Свойства класса
  * _submit: HTMLButtonElement - кнопка отправки формы
  * _form: HTMLElement - форма
	* _errors: HTMLElement - элемент ошибки
	* appState - appState

  ### Методы класса
  * set errors - установка текста ошибки

# Класс Order наследуется от Form
  Класс предназначен для управления состоянием формы заказа, обработчки событий ввода и отправки формы.

  ### Свойства класса
  * _paymentCard: HTMLButtonElement - метод оплаты картой
	* _paymentCash: HTMLButtonElement - метод оплаты при получении
	* _selectedMethod: 'card' | 'cash' | null = null - выбор метода оплаты

  ### Методы класса
  * onInputChange - вызывается при изменении полей формы
  * selectPayment - вызывается при изменении метода оплаты
  * renderButton - рендер кнопки отпрвки формы (делает кнопу неактивной и наоборот)

# Класс Contacts наследуется от Form
  Класс предназначен для управления состоянием формы контактов, обработчки событий ввода и отправки формы.

  ### Методы класса
  * onInputChange - вызывается при изменении полей формы
  * renderButton - рендер кнопки отпрвки формы (делает кнопу неактивной и наоборот)

# Класс Basket
  Класс для управления корзиной товаров. Позволяет открывать и закрывать модальное окно, а так же управлять его содержимым.

  ### Свойства класса
  * cardBasketTemplate: HTMLTemplateElement - template карточки корзины
	* basketCounter: HTMLElement - количество товаров в корзине
	* basketContainer: HTMLElement - контейнер корзины
	* basketPrice: HTMLElement - сумма корзины
	* basketPlace: HTMLElement - место корзины
	* list: IProduct[] - список товаров

  ### Методы класса
  * render - render корзины

# Класс Modal
  Класс для создания и управления модальными окнами. Позволяет открывать и закрывать модальное окно, а так же управлять его содержимым.

  ### Свойства класса
 * _closeButton: HTMLButtonElement - закрытие модального окна
 * _content: HTMLElement - контент модального окна
 * outsideClickHandler: (event: MouseEvent) => void - функция закрытия модального окна по клику на пустое пространство

  ### Методы класса
  * handleOutsideClick - функция закрытия модального окна по клику на пустое пространство
  * openModal - открыть модальное окно
  * closeModal - закрыть модальное окно
  * renderModal - render модального окна

# Дополнительные компоненты

# Класс AppState
  представляющий состояние приложения, включая данные каталога, предпросмотра, корзины, заказа и ошибок формы. 

  ### Свойства класса
  * catalog: IProduct[] - список товаров
  * basketList: IProduct[] - список товаров в корзине
  * order: IOrder - данные заказа
  * formErrors: FormErrors - ошибки форм 

  ### Методы класса
  * getTotal - возвращает кол-во товара
  * getTOtalPrice - возвращает общую сумму корзины
  * setCatalog - инициалазация события изменения каталога
  * clearBasket - очищение корзины
  * clearOrder - очищает заказ 
  * addBasketList - добавить в корзину
  * changeBasketList - удаляет item по id
  * setOrderField, setContactsField - сохранение заказа, данных и инициализация событий валидации
  * validateOrder - валидация заказа
  * validateContacts - валидация контактов

 # Класс ProductCard
  Класс представляет собой компонент карточки товара, предназначен для управления состоянием карточки и обработки собитый клика на неё.

  ### Свойства класса
  * _title: HTMLElement - название товара
  * _price: HTMLElement - цена товара
  * _category: HTMLElement - категория товара
  * _image?: HTMLImageElement - картинка товара
  * _button?: HTMLElement - кнопка действий с карточкой
  * index: number - id карточки
  * template: HTMLElement - template карточки

  ### Методы класса
   * set id - установка id
   * render - render крточки

# Класс SuccessModal
  Окно с сообщением об успешном действии

  ### Свойства класса
  * container: HTMLElement - элемент модального окна

# Класс ProductDetails
  Блок с подробной информацией о товаре

  ### Свойства класса
  * container: HTMLElement - элемент модального окна для просмотра товара
  * actionButton: HTMLElement - кнопка добовления в корзину

  ### Методы класса
   * setProduct(product) — получает объект товара и отображает его детали (название, изображение, цена, категория и т.д.)

# Класс CartItem
  Представление одного элемента в списке покупок (корзине)

  ### Методы класса
   * setProduct(product: IProduct, container: HTMLElement, callback: (id: string) => void) — принимает объект товара и отрисовывает его в виде карточки в корзине
   * updateQuantity(count) — обновляет количество товара
   * getTotalPrice() — возвращает итоговую цену товара (цена × количество)

# Класс PageLayout
  Класс, предназначенный для управления и отображения основных элементов страницы, таких как каталог продуктов, счетчик товаров в корзине, а так же позволяющий блокировать прокрутку страницы.

  ### Свойства класса
  * _catalog: HTMLElement - каталог товаров
  * _wrapper: HTMLElement - обёртка, lock страницы
  * _basketButton: HTMLElement - кнопка корзины
  * _buttonPlace: HTMLElement - кнопка оформления корзины
  * _counter: number - счётчик корзины

  ### Методы класса
  * set counter - счётчик корзины
  * get counter - получение счётчика корзины
  * set locked - lock интерфейса
  * addToCatalog - добавление карточек на страницу

# Предпросмотр товара
## preview:changed
Описание: Пользователь открыл карточку товара для просмотра.
Источник: ProductCard
Обработчик:

Показывает ProductDetails

Открывает модальное окно карточки

# Каталог товаров
## catalog:changed
Описание: Каталог обновлён (например, после загрузки с сервера).
Источник: AppState.setCatalog()
Обработчик:

Обновляет отображение карточек товаров в PageLayout

Отображает каждую карточку с помощью ProductCard

# Корзина
## basket:changed
Описание: Состав корзины изменился (добавление/удаление товара).
Источник: AppState.addBasketList(), AppState.changeBasketList(), AppState.clearBasket()
Обработчик:

Обновляет список товаров в ShoppingCart

# Заказ
## order:open
Описание: Открытие модального окна заказа
Источник: PageLayout
Обработчик:

Открывает форму заказа

# Заказ
## order:changed
Описание: Данные заказа обновлены (например, выбор способа оплаты).
Источник: Order, Contacts
Обработчик:

Обновляет данные

# Контакты
## contacts:open
Описание: Открытие модального окна контактов
Источник: Order
Обработчик:

Открывает форму контактов

# Заказ оформлен
## order:completed
Описание: Заказ успешно оформлен и отправлен.
Источник: после успешного Api.post()
Обработчик:

Показывает SuccessModal с сообщением

Очищает корзину (clearBasket())

Скрывает форму заказа